import{j as e,A as s,m as t,i as a}from"./ui-CC9fDAxl.js";import{d as l,r as i,e as n,L as r}from"./router-DKHyH_C6.js";import{c as o,d as c,S as d}from"./index-DmsZdVbW.js";import{P as x}from"./PageAnimator-cXsZvvrh.js";import{C as m}from"./CountdownTimer-B8MtocQT.js";import{m as h,R as u}from"./metaPixel-CVZjCYiw.js";import"./vendor-By4jc1MA.js";import"./differenceInCalendarDays-CQPmy639.js";const g=({raffleSlug:a,selectedTickets:i,totalPrice:n,onRemoveTicket:r,isSubmitting:o,raffle:c})=>{const d=l(),x=(null==c?void 0:c.boletosConOportunidades)&&(null==c?void 0:c.numeroOportunidades)>1?i.length*(c.numeroOportunidades-1):0,m=i.length+x;return e.jsx(s,{children:i.length>0&&e.jsx(t.div,{initial:{y:"100%"},animate:{y:"0%"},exit:{y:"100%"},transition:{type:"tween",ease:"easeInOut"},className:"fixed bottom-0 left-0 right-0 bg-background-secondary/90 backdrop-blur-sm p-4 border-t border-slate-700 shadow-lg z-40",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-2",children:[e.jsxs("p",{className:"text-sm text-slate-300",children:["Has seleccionado ",i.length," boleto(s)",x>0&&e.jsxs("span",{className:"text-green-400 font-semibold",children:[" + ",x," de regalo"]})]}),e.jsxs("p",{className:"font-bold text-white text-lg",children:["LPS ",n.toFixed(2),x>0&&e.jsxs("span",{className:"text-xs text-green-400 block mt-1",children:["Recibir√°s ",m," boletos en total"]})]})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-1 mb-3 max-h-20 overflow-y-auto no-scrollbar",children:i.map(s=>e.jsxs("button",{onClick:()=>r(s),className:"bg-blue-600 text-xs text-white px-2 py-1 rounded-full hover:bg-blue-700 transition-colors",children:[s," √ó"]},s))}),x>0&&e.jsx("div",{className:"text-center mb-3",children:e.jsxs("span",{className:"bg-gradient-to-r from-green-600 to-green-700 text-white text-xs font-semibold px-4 py-2 rounded-full inline-flex items-center gap-2 shadow-lg",children:["üéÅ + ",x," boletos de regalo"]})}),e.jsx("button",{onClick:()=>{const e=new URLSearchParams;e.append("tickets",i.join(",")),d(`/comprar/${a}?${e.toString()}`)},disabled:o,className:"w-full text-center bg-action text-white font-bold py-3 px-6 rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",children:o?"Procesando...":"Comprar Boletos"})]})})})},p=({totalTickets:l,occupiedTickets:n,selectedTickets:r,onTicketClick:o})=>{const[c,d]=i.useState(1),x=Math.ceil(l/50),m=()=>e.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-x-6 gap-y-2 mb-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-background-primary border border-slate-600"}),e.jsx("span",{children:"Disponible"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-accent"}),e.jsx("span",{children:"Seleccionado"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-slate-700/50 line-through"}),e.jsx("span",{children:"Vendido"})]})]});return e.jsxs("div",{className:"bg-background-secondary p-4 rounded-lg shadow-lg border border-slate-700/50",children:[e.jsx(m,{}),e.jsx("div",{className:"grid grid-cols-5 sm:grid-cols-10 gap-2",children:(()=>{const i=50*(c-1),d=i+50;return Array.from({length:l},(e,s)=>s+1).slice(i,d).map(i=>{const c=n.includes(i),d=r.includes(i);let x="";return x=c?"bg-slate-700/50 text-slate-500/50 cursor-not-allowed line-through":d?"bg-accent text-white font-bold shadow-neon-accent":"bg-background-primary text-slate-300 hover:bg-slate-700 hover:shadow-neon-accent",e.jsxs(t.div,{className:`relative p-1 text-center rounded-md text-sm cursor-pointer transition-all duration-200 flex items-center justify-center aspect-square ${x}`,onClick:()=>!c&&o(i),whileTap:{scale:c?1:.9},children:[e.jsx(s,{children:d&&e.jsx(t.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:"absolute inset-0 flex items-center justify-center",children:e.jsx(a,{size:16})})}),e.jsx("span",{className:d?"opacity-0":"opacity-100",children:String(i).padStart(String(l).length,"0")})]},i)})})()}),e.jsxs("div",{className:"flex justify-center items-center gap-4 mt-4 text-white",children:[e.jsx("button",{onClick:()=>d(e=>Math.max(1,e-1)),disabled:1===c,className:"px-3 py-1 bg-action rounded-md disabled:opacity-50",children:"Anterior"}),e.jsxs("span",{children:["P√°gina ",c," de ",x]}),e.jsx("button",{onClick:()=>d(e=>Math.min(x,e+1)),disabled:c===x,className:"px-3 py-1 bg-action rounded-md disabled:opacity-50",children:"Siguiente"})]})]})},b=()=>{var s,a;const{slug:l}=n(),[b,j]=i.useState(null),[f,N]=i.useState([]),[v,y]=i.useState([]),[w,k]=i.useState(!0);i.useEffect(()=>{l&&(k(!0),o(l).then(e=>{j(e||null),e?(h.trackViewContent(e.id,e),c(e.id).then(e=>{N(e),k(!1)})):k(!1)}).catch(e=>{console.error("Failed to load raffle details",e),k(!1)}))},[l]);const S=e=>{var s,t;if(f.includes(e))return void alert("Este boleto ya est√° ocupado. Por favor selecciona otro.");const a=v.includes(e),l=a?v.filter(s=>s!==e):[...v,e];if(y(l),!a&&b){const e=b.price||(null==(t=null==(s=b.packs)?void 0:s.find(e=>1===e.tickets||1===e.q))?void 0:t.price)||50,a=l.length*e;h.trackAddToCart(b.id,l,a)}};if(w)return e.jsx("div",{className:"w-full h-screen flex items-center justify-center bg-background-primary",children:e.jsx(d,{})});if(!b)return e.jsx(x,{children:e.jsx("div",{className:"text-center py-20",children:e.jsx("h2",{className:"text-2xl text-white",children:"Sorteo no encontrado."})})});const P=b.sold/b.tickets*100,C=b.price||(null==(a=null==(s=b.packs)?void 0:s.find(e=>1===e.tickets||1===e.q))?void 0:a.price)||50,T=v.length*C,O=b.boletosConOportunidades&&b.numeroOportunidades>1?v.length*(b.numeroOportunidades-1):0;return e.jsxs(x,{children:[e.jsx("div",{className:"container mx-auto px-4 py-10",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8",children:[e.jsxs("div",{className:"lg:col-span-3",children:[e.jsx(u,{images:b.imageUrl?(console.log("üñºÔ∏è Detail page using imageUrl"),[b.imageUrl]):b.gallery&&b.gallery.length>0?(console.log("üñºÔ∏è Detail page using gallery images:",b.gallery.length),b.gallery):b.heroImage?(console.log("üñºÔ∏è Detail page using heroImage"),[b.heroImage]):(console.log("üñºÔ∏è Detail page using default image"),["https://images.unsplash.com/photo-1513885535751-8b9238bd345a?w=800&h=600&fit=crop"]),title:b.title,className:"w-full max-w-2xl mx-auto mb-6"}),e.jsxs("div",{className:"bg-background-secondary p-6 rounded-lg border border-slate-700/50",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:b.title}),e.jsx("p",{className:"text-slate-300 mb-6",children:b.description||"Participa en esta incre√≠ble rifa"}),b.bonuses&&b.bonuses.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-bold mb-2 text-accent",children:"Bonos y Premios Adicionales"}),e.jsx("ul",{className:"list-disc list-inside text-slate-300 space-y-1",children:b.bonuses.map((s,t)=>e.jsx("li",{children:s},t))})]})]})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"sticky top-24 space-y-6",children:[e.jsxs("div",{className:"bg-background-secondary p-6 rounded-lg border border-slate-700/50 shadow-lg shadow-neon-accent",children:[e.jsx("h2",{className:"text-2xl font-bold text-center mb-4",children:"Participa Ahora"}),e.jsx(m,{targetDate:b.drawDate}),e.jsxs("div",{className:"my-6",children:[e.jsx("div",{className:"w-full bg-slate-700 rounded-full h-2.5",children:e.jsx(t.div,{className:"bg-accent h-2.5 rounded-full",initial:{width:0},animate:{width:`${P}%`},transition:{duration:1,ease:"easeOut"}})}),e.jsxs("p",{className:"text-center text-sm text-slate-300 mt-2",children:[P.toFixed(2),"% vendido"]})]}),e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("p",{className:"text-slate-400 mb-2",children:"Selecciona tus boletos de la tabla de abajo para comenzar."}),e.jsxs("div",{className:"bg-background-primary rounded-lg p-3 border border-slate-700/50 mb-4",children:[e.jsx("p",{className:"text-sm text-slate-300",children:"Precio por boleto:"}),e.jsxs("p",{className:"text-xl font-bold text-accent",children:["LPS ",C.toFixed(2)]})]}),b.boletosConOportunidades&&b.numeroOportunidades>1&&e.jsxs("div",{className:"bg-gradient-to-r from-green-900/30 to-blue-900/30 border-2 border-green-500/50 rounded-xl p-4 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:"üéØ"}),e.jsxs("h4",{className:"text-green-400 font-bold text-lg",children:[b.numeroOportunidades,"x Oportunidades"]})]}),e.jsxs("p",{className:"text-green-300 text-sm",children:["Cada boleto que compres recibir√° ",e.jsxs("span",{className:"font-bold text-white",children:[b.numeroOportunidades-1," boleto",b.numeroOportunidades>2?"s":""," adicional",b.numeroOportunidades>2?"es":""]})," de regalo para aumentar tus probabilidades"]})]})]})]}),e.jsx(p,{totalTickets:b.tickets,occupiedTickets:f,selectedTickets:v,onTicketClick:S}),v.length>0&&e.jsxs("div",{className:"bg-background-secondary p-6 rounded-lg border border-slate-700/50 shadow-lg",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4 text-center",children:"Resumen de Compra"}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between text-slate-300",children:[e.jsx("span",{children:"Boletos seleccionados:"}),e.jsx("span",{children:v.length})]}),O>0&&e.jsxs("div",{className:"flex justify-between text-green-400 font-semibold",children:[e.jsx("span",{children:"üéÅ Boletos de regalo:"}),e.jsxs("span",{children:["+",O]})]}),e.jsxs("div",{className:"flex justify-between text-slate-300",children:[e.jsx("span",{children:"Precio por boleto:"}),e.jsxs("span",{children:["LPS ",C.toFixed(2)]})]}),e.jsx("div",{className:"border-t border-slate-700/50 pt-2",children:e.jsxs("div",{className:"flex justify-between text-white font-bold text-lg",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{className:"text-accent",children:["LPS ",T.toFixed(2)]})]})}),O>0&&e.jsx("div",{className:"bg-green-900/20 border border-green-700/50 rounded-lg p-3 mt-3",children:e.jsxs("p",{className:"text-green-400 text-sm font-medium text-center",children:["üéØ Recibir√°s ",v.length+O," boletos en total",e.jsx("br",{}),"(",v.length," comprados + ",O," de regalo)"]})})]}),e.jsx(r,{to:`/comprar/${b.slug}?tickets=${v.join(",")}`,className:"block w-full text-center bg-action text-white font-bold py-3 px-6 rounded-lg hover:opacity-90 transition-opacity",children:"Proceder al Pago"})]})]})})]})}),e.jsx(g,{raffleSlug:b.slug,selectedTickets:v,totalPrice:T,onRemoveTicket:S,isSubmitting:!1,raffle:b})]})};export{b as default};
