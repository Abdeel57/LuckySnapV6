import{j as e,S as s,o as t,A as a,m as l,X as r}from"./ui-BjxIis6X.js";import{r as o}from"./router-Cu2lpERZ.js";import{S as n,h as i,n as c}from"./index-jkHuebR5.js";import{O as d}from"./types-Cl1VpbTU.js";import{f as x}from"./format-8hQqAUQ4.js";import{e as m}from"./es-DafM-x2e.js";import"./vendor-DOHx2j1n.js";import"./differenceInCalendarDays-CQPmy639.js";const p=({order:s,onClose:t,onConfirmPayment:a,onCancelOrder:o})=>e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-[100] flex items-center justify-center p-4",onClick:t,children:e.jsxs(l.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-800",children:["Folio: ",s.folio]}),e.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-gray-200",children:e.jsx(r,{})})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"Nombre:"})," ",s.name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"Teléfono:"})," ",s.phone]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"Departamento:"})," ",s.state]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"Rifa:"})," ",s.raffleTitle]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"Boletos:"})," ",s.tickets.join(", ")]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"Total:"})," LPS ",s.total.toFixed(2)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"Fecha:"})," ",x(s.createdAt,"P p",{locale:m})]})]}),s.status===d.PENDING&&e.jsxs("div",{className:"mt-6 border-t pt-4 space-y-2",children:[e.jsx("button",{onClick:()=>a(s.folio),className:"w-full bg-green-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-600",children:"Confirmar Pago"}),e.jsx("button",{onClick:()=>o(s.folio),className:"w-full bg-red-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-red-600",children:"Cancelar Apartado"})]})]})}),f=()=>{const[l,r]=o.useState([]),[x,m]=o.useState([]),[f,h]=o.useState(!0),[j,g]=o.useState(""),[u,b]=o.useState(null),y=async()=>{h(!0);const e=await i();r(e),m(e),h(!1)};o.useEffect(()=>{y()},[]),o.useEffect(()=>{const e=l.filter(e=>e.folio.toLowerCase().includes(j.toLowerCase())||e.name.toLowerCase().includes(j.toLowerCase())||e.phone.includes(j));m(e)},[j,l]);const N=async(e,s)=>{try{await c(e,s),y(),b(null)}catch(t){alert("Error al actualizar el estado")}};return e.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-lg shadow-md",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-800 mb-6",children:"Apartados"}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(s,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Ingrese el Folio, Nombre o Teléfono",value:j,onChange:e=>g(e.target.value),className:"w-full bg-gray-50 border border-gray-300 rounded-lg py-2 pl-10 pr-3 text-gray-800 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-2",children:"Listado de apartados"}),f?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(n,{})}):e.jsx("div",{className:"space-y-2",children:x.length>0?x.map(s=>e.jsxs("button",{onClick:()=>b(s),className:"w-full text-left flex justify-between items-center p-3 border-b border-gray-200 last:border-b-0 hover:bg-gray-50 rounded-md",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-800",children:[s.folio," - ",s.name]}),e.jsx("p",{className:"text-sm text-gray-500",children:s.raffleTitle})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-bold px-2 py-1 rounded-full "+(s.status===d.PAID?"bg-green-100 text-green-700":s.status===d.PENDING?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:s.status}),e.jsx(t,{size:20,className:"text-gray-400"})]})]},s.folio)):e.jsx("p",{className:"text-gray-500 p-3",children:"No se encontraron apartados."})}),e.jsx(a,{children:u&&e.jsx(p,{order:u,onClose:()=>b(null),onConfirmPayment:e=>N(e,d.PAID),onCancelOrder:e=>N(e,d.CANCELLED)})})]})};export{f as default};
