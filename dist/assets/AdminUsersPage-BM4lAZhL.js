import{j as e,Y as s,P as a,S as r,A as l,m as t,a2 as i,w as o,X as n}from"./ui-CC9fDAxl.js";import{r as d}from"./router-DKHyH_C6.js";import{u as c}from"./index.esm-kOr9XXcU.js";import{S as x,B as u,C as m,D as h,E as b}from"./index-DmsZdVbW.js";import"./vendor-By4jc1MA.js";const j=({user:s,onClose:a,onSave:r})=>{const{register:l,handleSubmit:i,formState:{errors:o,isSubmitting:d}}=c({defaultValues:s||{}}),x="w-full mt-1 p-3 border border-gray-300 rounded-xl bg-white text-gray-800 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200";return e.jsx(t.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-[200] flex items-center justify-center p-4",onClick:a,children:e.jsxs(t.div,{initial:{scale:.9,y:-20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-white rounded-2xl shadow-2xl p-6 w-full max-w-md",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:(null==s?void 0:s.id)?"Editar Usuario":"Nuevo Usuario"}),e.jsx("p",{className:"text-sm text-gray-600",children:(null==s?void 0:s.id)?"Modifica la información del usuario":"Agrega un nuevo usuario al sistema"})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-xl text-gray-500 hover:bg-gray-100 transition-all duration-200",children:e.jsx(n,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:i(e=>{r({...s,...e})}),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Nombre Completo"}),e.jsx("input",{...l("name",{required:"El nombre es requerido"}),className:x}),o.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email"}),e.jsx("input",{...l("email",{required:"El email es requerido",pattern:{value:/^\S+@\S+$/i,message:"Email inválido"}}),className:x}),o.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Contraseña"}),e.jsx("input",{...l("password",{required:"La contraseña es requerida",minLength:{value:6,message:"Mínimo 6 caracteres"}}),type:"password",className:x}),o.password&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.password.message})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-all duration-200",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:d,className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Guardando...":(null==s?void 0:s.id)?"Actualizar":"Crear"})]})]})]})})},p=()=>{const[n,c]=d.useState([]),[p,g]=d.useState(!0),[y,f]=d.useState(!1),[N,v]=d.useState(null),[w,C]=d.useState(""),[S,k]=d.useState("all"),E=async()=>{g(!0);const e=await u();c(e),g(!1)};d.useEffect(()=>{E()},[]);const q=(e=null)=>{v(e),f(!0)},U=()=>{v(null),f(!1)},L=n.filter(e=>{const s=e.name.toLowerCase().includes(w.toLowerCase())||e.email.toLowerCase().includes(w.toLowerCase()),a="all"===S||e.role===S;return s&&a});return p?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx(x,{}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Cargando usuarios..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-200 p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(s,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Usuarios"}),e.jsx("p",{className:"text-gray-600",children:"Gestiona los usuarios del sistema"})]})]}),e.jsx("div",{className:"flex gap-3",children:e.jsxs("button",{onClick:()=>q(),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors",children:[e.jsx(a,{className:"w-4 h-4"}),e.jsx("span",{children:"Nuevo Usuario"})]})})]})}),e.jsx("div",{className:"bg-white rounded-2xl p-4 shadow-lg border border-gray-200 mb-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(r,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Buscar usuarios...",value:w,onChange:e=>C(e.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-sm"})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("select",{value:S,onChange:e=>k(e.target.value),className:"px-3 py-2.5 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-sm",children:[e.jsx("option",{value:"all",children:"Todos los roles"}),e.jsx("option",{value:"user",children:"Usuarios"}),e.jsx("option",{value:"admin",children:"Administradores"})]})})]})}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.jsx(l,{children:L.map(s=>e.jsxs(t.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-2xl shadow-lg border border-gray-200 p-6 hover:shadow-xl transition-shadow",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:s.name}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("p",{children:["📧 ",s.email]}),e.jsx("p",{className:"font-bold "+("admin"===s.role?"text-red-600":"text-blue-600"),children:"admin"===s.role?"🛡️ Administrador":"👤 Usuario"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>q(s),className:"flex items-center justify-center space-x-2 px-3 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors text-sm",children:[e.jsx(i,{className:"w-4 h-4"}),e.jsx("span",{children:"Editar"})]}),e.jsxs("button",{onClick:()=>(async e=>{if(window.confirm("¿Estás seguro de que quieres eliminar este usuario?"))try{await m(e),E()}catch(s){console.error("Failed to delete user",s),alert("Error al eliminar el usuario.")}})(s.id),className:"flex items-center justify-center space-x-2 px-3 py-2 bg-red-600 text-white rounded-xl hover:bg-red-700 transition-colors text-sm",children:[e.jsx(o,{className:"w-4 h-4"}),e.jsx("span",{children:"Eliminar"})]})]})]},s.id))})}),0===L.length&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx(s,{className:"w-16 h-16 mx-auto"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No se encontraron usuarios"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Intenta ajustar los filtros o crear un nuevo usuario"}),e.jsx("button",{onClick:()=>q(),className:"bg-blue-500 text-white px-6 py-3 rounded-xl hover:bg-blue-600 transition-all duration-200",children:"Crear Nuevo Usuario"})]}),e.jsx(l,{children:y&&e.jsx(j,{user:N,onClose:U,onSave:async e=>{try{(null==N?void 0:N.id)?await h(N.id,{...N,...e}):await b(e),E(),U()}catch(s){console.error("Failed to save user",s),alert("Error al guardar el usuario.")}}})})]})};export{p as default};
