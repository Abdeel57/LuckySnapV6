import{j as e}from"./ui-BjxIis6X.js";import{e as t,f as s,d as a,r as l}from"./router-Cu2lpERZ.js";import{u as r}from"./index.esm-7w44b31V.js";import{c as o,g as n,S as c,e as i}from"./index-jkHuebR5.js";import{P as d}from"./PageAnimator-Be5iS2Sm.js";import"./vendor-DOHx2j1n.js";const m=()=>{var m,x;const{slug:p}=t(),[h]=s();a();const[u,b]=l.useState(null),[f,j]=l.useState(!0),[g,N]=l.useState(!1),[w,y]=l.useState(null),[v,k]=l.useState([]),[S,P]=l.useState(""),C=(null==(m=h.get("tickets"))?void 0:m.split(",").map(Number).filter(e=>!isNaN(e)))||[],{register:q,handleSubmit:E,formState:{errors:F}}=r();l.useEffect(()=>{p&&(j(!0),Promise.all([o(p),n()]).then(([e,t])=>{b(e||null),k(t.paymentAccounts),P(t.contactInfo.whatsapp)}).catch(e=>console.error(e)).finally(()=>j(!1)))},[p]);const A=(null==(x=null==u?void 0:u.packs.find(e=>1===e.q))?void 0:x.price)||0,T=C.length*A;return f?e.jsx("div",{className:"w-full h-screen flex items-center justify-center bg-background-primary",children:e.jsx(c,{})}):u?w?e.jsx(d,{children:e.jsxs("div",{className:"container mx-auto px-4 py-12 max-w-2xl text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-accent mb-4",children:"¡Tu Apartado ha sido Creado!"}),e.jsx("p",{className:"text-slate-300 mb-8",children:"Utiliza el siguiente folio como concepto de pago al realizar tu transferencia."}),e.jsxs("div",{className:"bg-background-secondary p-6 rounded-lg border border-slate-700/50 mb-8",children:[e.jsx("p",{className:"text-slate-400 text-sm",children:"Folio / Concepto de Pago"}),e.jsx("p",{className:"text-4xl font-mono text-white tracking-widest",children:w.folio})]}),e.jsxs("div",{className:"text-left mb-8",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Cuentas para Realizar tu Pago"}),e.jsx("div",{className:"space-y-4",children:v.map(t=>e.jsxs("div",{className:"bg-background-secondary p-4 rounded-lg text-sm",children:[e.jsx("p",{className:"font-bold text-white",children:t.bank}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-400",children:"Titular:"})," ",t.accountHolder]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-400",children:"CLABE:"})," ",t.clabe]})]},t.id))})]}),e.jsx("a",{href:`https://wa.me/${S.replace(/\D/g,"")}?text=Hola!%20Quiero%20enviar%20mi%20comprobante%20para%20el%20folio%20${w.folio}`,target:"_blank",rel:"noopener noreferrer",className:"inline-block w-full text-center bg-green-500 text-white font-bold py-3 px-6 rounded-lg hover:opacity-90 transition-opacity",children:"Enviar Comprobante de Pago"})]})}):e.jsx(d,{children:e.jsxs("div",{className:"container mx-auto px-4 py-12 max-w-2xl",children:[e.jsx("h1",{className:"text-3xl font-bold text-center text-white mb-2",children:"Confirmar Compra"}),e.jsxs("p",{className:"text-center text-slate-300 mb-8",children:["Estás a un paso de apartar tus boletos para: ",u.title]}),e.jsxs("div",{className:"bg-background-secondary p-8 rounded-lg border border-slate-700/50 shadow-lg",children:[e.jsx("img",{src:u.heroImage,alt:u.title,className:"w-full h-48 object-cover rounded-lg mb-6"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Boletos Seleccionados"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:C.map(t=>e.jsx("span",{className:"bg-background-primary px-3 py-1 rounded-full text-sm font-mono",children:t},t))})]}),e.jsxs("form",{onSubmit:E(async e=>{if(u&&0!==C.length){N(!0);try{const t={...e,raffleId:u.id,raffleTitle:u.title,tickets:C,total:T},s=await i(t);y(s)}catch(t){console.error(t),alert("Hubo un error al crear tu apartado.")}finally{N(!1)}}}),className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white border-t border-slate-700/50 pt-6",children:"Completa tus datos"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-white mb-1",children:"Nombre Completo"}),e.jsx("input",{id:"name",...q("name",{required:"El nombre es requerido"}),className:"w-full bg-slate-800 border border-slate-700 rounded-md py-2 px-3 text-white focus:ring-accent focus:border-accent"}),F.name&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:F.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-white mb-1",children:"Teléfono (8 dígitos)"}),e.jsx("input",{id:"phone",type:"tel",...q("phone",{required:"El teléfono es requerido",pattern:{value:/^\d{8}$/,message:"Ingresa un teléfono válido de 8 dígitos"}}),className:"w-full bg-slate-800 border border-slate-700 rounded-md py-2 px-3 text-white focus:ring-accent focus:border-accent"}),F.phone&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:F.phone.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"state",className:"block text-sm font-medium text-white mb-1",children:"Departamento"}),e.jsx("input",{id:"state",...q("state",{required:"El departamento es requerido"}),className:"w-full bg-slate-800 border border-slate-700 rounded-md py-2 px-3 text-white focus:ring-accent focus:border-accent"}),F.state&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:F.state.message})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-700 text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-white",children:["Total a Pagar: LPS ",T.toFixed(2)]}),e.jsxs("p",{className:"text-slate-400",children:["Por ",C.length," boleto(s)"]}),e.jsx("button",{type:"submit",disabled:g||0===C.length,className:"mt-4 w-full bg-action text-white font-bold py-3 px-12 rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",children:g?"Apartando...":"Generar Folio para Pagar"})]})]})]})]})}):e.jsx(d,{children:e.jsx("div",{className:"text-center py-20",children:e.jsx("h2",{className:"text-2xl text-white",children:"Sorteo no encontrado."})})})};export{m as default};
