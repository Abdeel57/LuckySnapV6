import{j as t,A as e,m as n}from"./ui-CC9fDAxl.js";import{r as s,c as o}from"./router-DKHyH_C6.js";import{t as a,c as r,n as l,d as i,m as u,a as c}from"./differenceInCalendarDays-CQPmy639.js";function d(t,e,n){const{years:s=0,months:o=0,weeks:l=0,days:i=0,hours:u=0,minutes:c=0,seconds:d=0}=e,m=a(t,null==n?void 0:n.in),g=o||s?function(t,e,n){const s=a(t,null==n?void 0:n.in);if(isNaN(e))return r(t,NaN);if(!e)return s;const o=s.getDate(),l=r(t,s.getTime());return l.setMonth(s.getMonth()+e+1,0),o>=l.getDate()?l:(s.setFullYear(l.getFullYear(),l.getMonth(),o),s)}(m,o+12*s):m,h=i||l?function(t,e,n){const s=a(t,null==n?void 0:n.in);return isNaN(e)?r(t,NaN):e?(s.setDate(s.getDate()+e),s):s}(g,i+7*l):g;return r(t,+h+1e3*(d+60*(c+60*u)))}function m(t,e){const n=+a(t)-+a(e);return n<0?-1:n>0?1:n}function g(t,e){const n=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}function h(t){return e=>{const n=(t?Math[t]:Math.trunc)(e);return 0===n?0:n}}function x(t,e){return+a(t)-+a(e)}function f(t,e){const n=a(t,null==e?void 0:e.in);return+function(t,e){const n=a(t,null==e?void 0:e.in);return n.setHours(23,59,59,999),n}(n,e)===+function(t,e){const n=a(t,null==e?void 0:e.in),s=n.getMonth();return n.setFullYear(n.getFullYear(),s+1,0),n.setHours(23,59,59,999),n}(n,e)}function v(t,e,n){const[s,o,a]=l(null==n?void 0:n.in,t,t,e),r=m(o,a),i=Math.abs(function(t,e,n){const[s,o]=l(null==n?void 0:n.in,t,e);return 12*(s.getFullYear()-o.getFullYear())+(s.getMonth()-o.getMonth())}(o,a));if(i<1)return 0;1===o.getMonth()&&o.getDate()>27&&o.setDate(30),o.setMonth(o.getMonth()-r*i);let u=m(o,a)===-r;f(s)&&1===i&&1===m(s,a)&&(u=!1);const c=r*(i-+u);return 0===c?0:c}function b(t,e,n){const[s,o]=l(null==n?void 0:n.in,t,e),a=m(s,o),r=Math.abs(function(t,e,n){const[s,o]=l(null==n?void 0:n.in,t,e);return s.getFullYear()-o.getFullYear()}(s,o));s.setFullYear(1584),o.setFullYear(1584);const i=a*(r-+(m(s,o)===-a));return 0===i?0:i}function N(t,e){const{start:n,end:s}=function(t,e){const[n,s]=l(t,e.start,e.end);return{start:n,end:s}}(null==e?void 0:e.in,t),o={},a=b(s,n);a&&(o.years=a);const r=d(n,{years:o.years}),m=v(s,r);m&&(o.months=m);const f=d(r,{months:o.months}),N=function(t,e,n){const[s,o]=l(null==n?void 0:n.in,t,e),a=g(s,o),r=Math.abs(i(s,o));s.setDate(s.getDate()-a*r);const u=a*(r-Number(g(s,o)===-a));return 0===u?0:u}(s,f);N&&(o.days=N);const M=d(f,{days:o.days}),j=function(t,e,n){const[s,o]=l(null==n?void 0:n.in,t,e),a=(+s-+o)/u;return h(null==n?void 0:n.roundingMethod)(a)}(s,M);j&&(o.hours=j);const y=d(M,{hours:o.hours}),D=function(t,e,n){const s=x(t,e)/c;return h(null==n?void 0:n.roundingMethod)(s)}(s,y);D&&(o.minutes=D);const p=function(t,e,n){const s=x(t,e)/1e3;return h(null==n?void 0:n.roundingMethod)(s)}(s,d(y,{minutes:o.minutes}));return p&&(o.seconds=p),o}const M=({targetDate:r})=>{const l=()=>{const t=new Date,e=new Date(r);if(isNaN(e.getTime()))return console.error("Invalid target date:",r),{days:0,hours:0,minutes:0,seconds:0};if(n=e,+a(t)>+a(n))return{days:0,hours:0,minutes:0,seconds:0};var n;const s=N({start:t,end:e});return{days:s.days||0,hours:s.hours||0,minutes:s.minutes||0,seconds:s.seconds||0}},[i,u]=s.useState(l());s.useEffect(()=>{console.log("🕐 CountdownTimer initialized with targetDate:",r),console.log("🕐 Calculated time left:",l());const t=setInterval(()=>{const t=l();u(t),t.minutes!==i.minutes&&console.log("🕐 Time updated:",t)},1e3);return()=>clearInterval(t)},[r]);const c=[{label:"Día",value:i.days},{label:"Hora",value:i.hours},{label:"Minuto",value:i.minutes},{label:"Segundo",value:i.seconds}],d=new Date(r);return isNaN(d.getTime())?t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-red-400 text-lg mb-2",children:"⚠️"}),t.jsx("div",{className:"text-red-400 text-sm",children:"Fecha de sorteo inválida"})]}):0===i.days&&0===i.hours&&0===i.minutes&&0===i.seconds?t.jsx("div",{className:"text-center font-bold text-accent text-2xl",children:"¡EL SORTEO HA FINALIZADO!"}):t.jsx("div",{className:"flex justify-center items-center gap-1 sm:gap-3 flex-wrap",children:c.map((s,a)=>t.jsxs(o.Fragment,{children:[t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsxs("span",{className:"text-xs sm:text-sm text-slate-300 mb-2",children:[s.label,1!==s.value?"s":""]}),t.jsx("div",{className:"flex gap-1",children:String(s.value).padStart(2,"0").split("").map((s,o)=>t.jsxs("div",{className:"relative w-6 h-8 sm:w-10 sm:h-12 md:w-12 md:h-16 bg-background-primary rounded-md shadow-lg overflow-hidden border border-slate-600",children:[t.jsx(e,{children:t.jsx(n.div,{initial:{y:"-100%"},animate:{y:"0%"},exit:{y:"100%"},transition:{duration:.3,ease:"easeInOut"},className:"absolute inset-0 flex items-center justify-center text-lg sm:text-2xl md:text-4xl font-bold text-white",children:s},s)}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/10 to-black/30"}),t.jsx("div",{className:"absolute top-1/2 left-0 w-full h-px bg-black/40"})]},o))})]}),a<c.length-1&&t.jsx("div",{className:"text-xl sm:text-2xl md:text-3xl text-slate-400 mt-4 font-bold",children:":"})]},s.label))})};export{M as C};
