import{j as e,A as s,m as t,e as a}from"./ui-BjxIis6X.js";import{d as l,r as i,e as c}from"./router-Cu2lpERZ.js";import{c as n,d as r,S as d}from"./index-jkHuebR5.js";import{P as o}from"./PageAnimator-Be5iS2Sm.js";import{C as x}from"./CountdownTimer-B3z9_dwv.js";import"./vendor-DOHx2j1n.js";import"./differenceInCalendarDays-CQPmy639.js";const m=({raffleSlug:a,selectedTickets:i,totalPrice:c,onRemoveTicket:n,isSubmitting:r})=>{const d=l();return e.jsx(s,{children:i.length>0&&e.jsx(t.div,{initial:{y:"100%"},animate:{y:"0%"},exit:{y:"100%"},transition:{type:"tween",ease:"easeInOut"},className:"fixed bottom-0 left-0 right-0 bg-background-secondary/90 backdrop-blur-sm p-4 border-t border-slate-700 shadow-lg z-40",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-2",children:[e.jsxs("p",{className:"text-sm text-slate-300",children:["Has seleccionado ",i.length," boleto(s)"]}),e.jsxs("p",{className:"font-bold text-white text-lg",children:["LPS ",c.toFixed(2)]})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-1 mb-3 max-h-20 overflow-y-auto no-scrollbar",children:i.map(s=>e.jsxs("button",{onClick:()=>n(s),className:"bg-background-primary text-xs text-white px-2 py-1 rounded-full",children:[s," ×"]},s))}),e.jsx("button",{onClick:()=>{const e=new URLSearchParams;e.append("tickets",i.join(",")),d(`/comprar/${a}?${e.toString()}`)},disabled:r,className:"w-full text-center bg-action text-white font-bold py-3 px-6 rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",children:r?"Procesando...":"Comprar Boletos"})]})})})},h=({totalTickets:l,occupiedTickets:c,selectedTickets:n,onTicketClick:r})=>{const[d,o]=i.useState(1),x=Math.ceil(l/50),m=()=>e.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-x-6 gap-y-2 mb-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-background-primary border border-slate-600"}),e.jsx("span",{children:"Disponible"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-accent"}),e.jsx("span",{children:"Seleccionado"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-slate-700/50 line-through"}),e.jsx("span",{children:"Vendido"})]})]});return e.jsxs("div",{className:"bg-background-secondary p-4 rounded-lg shadow-lg border border-slate-700/50",children:[e.jsx(m,{}),e.jsx("div",{className:"grid grid-cols-5 sm:grid-cols-10 gap-2",children:(()=>{const i=50*(d-1),o=i+50;return Array.from({length:l},(e,s)=>s+1).slice(i,o).map(i=>{const d=c.includes(i),o=n.includes(i);let x="";return x=d?"bg-slate-700/50 text-slate-500/50 cursor-not-allowed line-through":o?"bg-accent text-white font-bold shadow-neon-accent":"bg-background-primary text-slate-300 hover:bg-slate-700 hover:shadow-neon-accent",e.jsxs(t.div,{className:`relative p-1 text-center rounded-md text-sm cursor-pointer transition-all duration-200 flex items-center justify-center aspect-square ${x}`,onClick:()=>!d&&r(i),whileTap:{scale:d?1:.9},children:[e.jsx(s,{children:o&&e.jsx(t.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:"absolute inset-0 flex items-center justify-center",children:e.jsx(a,{size:16})})}),e.jsx("span",{className:o?"opacity-0":"opacity-100",children:String(i).padStart(String(l).length,"0")})]},i)})})()}),e.jsxs("div",{className:"flex justify-center items-center gap-4 mt-4 text-white",children:[e.jsx("button",{onClick:()=>o(e=>Math.max(1,e-1)),disabled:1===d,className:"px-3 py-1 bg-action rounded-md disabled:opacity-50",children:"Anterior"}),e.jsxs("span",{children:["Página ",d," de ",x]}),e.jsx("button",{onClick:()=>o(e=>Math.min(x,e+1)),disabled:d===x,className:"px-3 py-1 bg-action rounded-md disabled:opacity-50",children:"Siguiente"})]})]})},u=()=>{var s;const{slug:a}=c(),[l,u]=i.useState(null),[p,g]=i.useState([]),[j,b]=i.useState([]),[f,N]=i.useState(!0);i.useEffect(()=>{a&&(N(!0),n(a).then(e=>{u(e||null),e?r(e.id).then(e=>{g(e),N(!1)}):N(!1)}).catch(e=>{console.error("Failed to load raffle details",e),N(!1)}))},[a]);const v=e=>{b(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])};if(f)return e.jsx("div",{className:"w-full h-screen flex items-center justify-center bg-background-primary",children:e.jsx(d,{})});if(!l)return e.jsx(o,{children:e.jsx("div",{className:"text-center py-20",children:e.jsx("h2",{className:"text-2xl text-white",children:"Sorteo no encontrado."})})});const y=l.sold/l.tickets*100,k=(null==(s=l.packs.find(e=>1===e.q))?void 0:s.price)||0,w=j.length*k;return e.jsxs(o,{children:[e.jsx("div",{className:"container mx-auto px-4 py-10",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8",children:[e.jsxs("div",{className:"lg:col-span-3",children:[e.jsx("img",{src:l.heroImage,alt:l.title,className:"w-full rounded-lg shadow-lg mb-4"}),e.jsxs("div",{className:"bg-background-secondary p-6 rounded-lg border border-slate-700/50",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:l.title}),e.jsx("p",{className:"text-slate-300 mb-6",children:l.description}),l.bonuses.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-bold mb-2 text-accent",children:"Bonos y Premios Adicionales"}),e.jsx("ul",{className:"list-disc list-inside text-slate-300 space-y-1",children:l.bonuses.map((s,t)=>e.jsx("li",{children:s},t))})]})]})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"sticky top-24 space-y-6",children:[e.jsxs("div",{className:"bg-background-secondary p-6 rounded-lg border border-slate-700/50 shadow-lg shadow-neon-accent",children:[e.jsx("h2",{className:"text-2xl font-bold text-center mb-4",children:"Participa Ahora"}),e.jsx(x,{targetDate:l.drawDate}),e.jsxs("div",{className:"my-6",children:[e.jsx("div",{className:"w-full bg-slate-700 rounded-full h-2.5",children:e.jsx(t.div,{className:"bg-accent h-2.5 rounded-full",initial:{width:0},animate:{width:`${y}%`},transition:{duration:1,ease:"easeOut"}})}),e.jsxs("p",{className:"text-center text-sm text-slate-300 mt-2",children:[y.toFixed(2),"% vendido"]})]}),e.jsx("p",{className:"text-center text-slate-400",children:"Selecciona tus boletos de la tabla de abajo para comenzar."})]}),e.jsx(h,{totalTickets:l.tickets,occupiedTickets:p,selectedTickets:j,onTicketClick:v})]})})]})}),e.jsx(m,{raffleSlug:l.slug,selectedTickets:j,totalPrice:w,onRemoveTicket:v,isSubmitting:!1})]})};export{u as default};
